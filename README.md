## 校园包车订票系统设计

### 1.系统运用的工具
- 开发工具：Pycharm
- 开发语言：Python 2.7.13
- 框架：Django 1.10.1   Bootstrap 3.3.7
- 数据库：Mysql 5.5.47


### 2.系统功能的概述
校园包车订票系统主要功能如下：
#### 2.1前台部分
#### 2.1.1用户管理
- 注册：手机号、姓名、密码
- 登录：通过手机号登录；未登录时，可查询车票，但不能购买
- 忘记密码：通过手机获取验证码，重新设置新密码
- 密码修改：通过获取手机验证码，重新修改密码
- 个人资料填写和修改
- 注销：退出账号后返回系统首页

#### 2.1.2车票查询
- 根据地点（起点和终点）、时间搜索，查看符合查询条件的车次信息。

#### 2.1.3预订车票
- 选择班次、购买数量下单并支付，若半小时内不支付订单失效。
- 支付方式：微信支付、支付宝支付
- 赶不上车的情况下，若今天内同路线的车次还有余票可以改签，若没有余票只能选择退款（50%）

#### 2.1.4查看订单信息
- 订单信息包括乘坐路线、购买数量、支付状态、起点、终点、乘车时间等
- 订单分为以下三中类型：
<br>待支付：下了订单，未支付；若半小时后订单未支付，订单失效
<br>待出行：已付款，未出行；有取消车票或者改签的功能
<br>已出行：已完成的订单

#### 2.1.5帮助信息
- 用户可以留言，提交。

#### 2.2后台部分
#### 2.2.1账号管理
- 管理员：权限管理，录入普通管理员的信息、用户信息的查询
- 普通管理员：个人信息填写修改，以及用户信息的查询。

#### 2.2.2车次管理
- 设置车次的相关信息，只有开通的路线才能设置车次（增）
- 删除车次（删）
- 对车次信息进行修改（改）
- 通过车次编号、时间、地点等模糊搜索查看信息(查)

#### 2.2.3路线管理
- 设置新路线信息，开通新路线（增）
- 删除路线（删）
- 对路线进行修改（改）
- 通过地点查看路线信息：起始城市、目的城市、上车点、下车点（查）

#### 2.2.4订单管理
- 通过地点、订单状态、支付状态、车次编号等进行模糊搜索查看（查）
- 可对订单进行修改（改）

#### 2.2.5车讯管理
- 在发车前一天设置、发送车讯提醒用户（增）
- 删除车讯（删）
- 可对未发送的车讯进行编辑（改）
- 通过车次编号查看车讯详情（查）

#### 2.2.6帮助信息管理
- 对帮助信息的增删改查

#### 2.2.7意见反馈
- 通过时间搜索意见信息
- 回复用户

### 3.数据库表设计
#### 3.1管理员表（manager）

列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
M_id | int |  20  | 是 | 管理员编号
M_name | varchar | 50 |	否 | 管理员名字
M_pwd |	varchar | 50 | 否 |	管理员登录密码
M_sex |	varchar | 20 | 否 |	管理员性别
M_phone	| varchar |	11 | 否 | 管理员电话
M_type | int | 20 | 否 | 管理员权限


#### 3.2用户表（user）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
U_id | int | 20 | 是 | 用户id
U_phone | varchar |	11 | 否 | 用户号码
U_name | varchar | 50 | 否 | 用户名字
U_pwd |	varchar	| 50 | 否 | 登录密码
U_sex |	varchar | 20 | 否 | 用户性别
U_addr | varchar | 50 |	否 | 地址（城市）
U_school | varchar | 100 | 否 |用户学校

#### 3.3车次（train）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
T_id | varchar | 20 | 是 | 车次编号
T_name |varchar	| 50 | 否 | 车次名
R_id |varchar | 20 | 是	| 路线编号
T_starttime | datetime | 50 | 否 | 出发时间
T_arrttime | datetime |	50 | 否 | 到达时间
T_price | float | 50 | 否 |	单价
T_num |	int | 20 | 否 |	车票数量
T_yp | int | 20 | 否 | 余票
T_car |	varchar | 20 | 否 | 车牌号

#### 3.4路线（route）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
R_id | varchar | 20 | 是 | 路线编号
R_startcity | varchar |	50 | 否 | 起始城市
R_arrtcity | datetime |	50 | 否 | 目的城市
R_startplace | varchar | 50 | 否 | 上车点
R_arrtplace | datetime | 50 | 否 | 下车点

#### 3.5订单（order）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
O_id | int | 20 | 是 | 订单编号
U_id | int | 20 | 是 | 用户id
T_id | varchar | 20 | 否 | 车次编号
O_num | int | 20 | 否 | 购买数量
O_totalpri | float | 50 | 否 | 总价
O_orderstates |	varchar | 20 |	否 |	订单状态（已出行、待出行、取消）
O_paystates | varchar |	20 | 否 |	付款状态（已支付、待支付）
O_paymode | varchar | 20 | 否 |	付款方式（微信、支付宝）
O_ordertime	 | datetime | 50 |	否 |下单时间

#### 3.6意见反馈（suggestion）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
SU_id |	int | 20 | 是 |	建议id
U_id | int | 20 | 否 | 用户id
SU_time | datetime | 50 | 否 | 反馈的时间
SU_content | varchar | 150 | 否 | 内容

#### 3.7车讯（inform）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
I_id | int | 20 | 是 | 车讯id
T_id | varchar | 20 | 否 | 车次编号
I_content | varchar | 150 |	否 | 内容

#### 3.8帮助信息（help）
列名 | 数据类型 | 长度 | 是否主键 | 说明 |
:---:|:---:|:---:|:---:|:---:
H_id | int | 20 | 是 | 帮助信息id
SU_content | varchar | 150 | 否 | 内容




### 4 页面大概设计
#### 4.1 前台
<br>顶部：登录（弹出对话框）、注册（弹出对话框）、退出(返回到首页)
<br>底部：链接

#### 4.1.1首页（u_main.html)
- 左边：预售车次
<br>（1）起点
<br>（2）终点
<br>（3）日期
<br>（4）立刻查询（查询结果显示在u_book.html）

- 中间：轮播图片

- 右边：帮助指南
<br>（1）显示几条帮助信息
<br>（2）[链接]更多信息（跳转到u_help.html）

#### 4.1.2在线订票（u_book.html）
- 左边：显示车票信息
<br>（1）查询
<br>（2）显示具体信息(车次、方向、发车日期、发车时间、到达时间、起点、终点、票价、订票[按钮]：点击跳转到u_buy.html)

- 右边：帮助指南

#### 4.1.3帮助信息（u_help.html）
- 左边：帮助信息的目录（标题）
- 右边：显示详细的信息内容

#### 4.1.4个人中心（u_own.html）
- 左边：目录
<br>（1）我的车票：全部、待出行、已出行、待支付
<br>（2）信息管理：修改密码、修改个人信息
<br>（3）车讯信息

- 右边：显示具体的信息
<br>（1）我的车票[列表]:订单编号、车次、发车日期、发车时间、起点、终点、票价、付款状态、操作（退票、改签）
<br>（2）修改密码:旧密码、新密码、确认密码、[按钮]修改密码
<br>（3）修改个人信息：名字、号码、性别、地址、学校
<br>（4）车讯信息：显示车讯信息

#### 4.1.5意见反馈（u_suggestion.html)
- 左边：预售车次
- 右边：意见反馈填写
<br>姓名
<br>联系方式
<br>留言框
<br>[按钮]提交
